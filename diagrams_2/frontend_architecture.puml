@startuml Frontend_Feature_Based_Architecture

skinparam componentStyle rectangle

!define LIGHTBLUE #E3F2FD
!define LIGHTGREEN #E8F5E9
!define LIGHTYELLOW #FFF9C4
!define LIGHTPINK #FCE4EC
!define LIGHTPURPLE #F3E5F5

package "src/" {

  package "features/ (Feature-Based Architecture)" {

    package "auth/" LIGHTBLUE {
      folder "pages/" {
        [LoginPage.jsx]
        [RegisterPage.jsx]
        [OTPPage.jsx]
      }
      folder "components/" {
        [LoginForm.jsx]
        [OTPInput.jsx]
      }
      folder "services/" {
        [auth.service.js]
      }
      folder "hooks/" {
        [useAuth.js]
        [useOTP.js]
      }
      folder "context/" {
        [AuthContext.jsx]
      }
    }

    package "story/" LIGHTGREEN {
      folder "pages/" as StoryPages {
        [Manager.jsx]
        [VisualEditor.jsx]
      }
      folder "components/" as StoryComp {
        [BookCard.jsx]
        [BookForm.jsx]
        [TuesdayJsReaderWrapper.jsx]
      }
      folder "services/" as StorySvc {
        [story.service.js]
      }
      folder "hooks/" as StoryHooks {
        [useBooks.js]
        [useBookContent.js]
      }
    }

    package "child/" LIGHTPINK {
      folder "pages/" as ChildPages {
        [Library.jsx]
        [Reader.jsx]
        [CharactersPage.jsx]
      }
      folder "components/" as ChildComp {
        [BookGrid.jsx]
        [CharacterCard.jsx]
      }
      folder "services/" as ChildSvc {
        [child.service.js]
      }
      folder "hooks/" as ChildHooks {
        [useLibrary.js]
        [useReadingProgress.js]
      }
    }

    package "editor/" LIGHTYELLOW {
      folder "pages/" as EditorPages {
        [CatalogPage.jsx]
        [CollectionsPage.jsx]
        [CollectionDetailsPage.jsx]
      }
      folder "components/" as EditorComp {
        [CollectionForm.jsx]
        [BookSelector.jsx]
      }
      folder "services/" as EditorSvc {
        [editor.service.js]
      }
      folder "hooks/" as EditorHooks {
        [useCollections.js]
        [useCatalog.js]
      }
    }

    package "admin/" LIGHTPURPLE {
      folder "pages/" as AdminPages {
        [UsersPage.jsx]
        [ReportsPage.jsx]
      }
      folder "components/" as AdminComp {
        [UserTable.jsx]
        [ReportDetails.jsx]
      }
      folder "services/" as AdminSvc {
        [admin.service.js]
      }
      folder "hooks/" as AdminHooks {
        [useUsers.js]
        [useReports.js]
      }
    }
  }

  package "shared/" {
    folder "components/" {
      [Button.jsx]
      [Input.jsx]
      [Card.jsx]
      [LoadingState.jsx]
      [ErrorBoundary.jsx]
    }
    folder "hooks/" {
      [useFetch.js]
      [useDebounce.js]
    }
    folder "utils/" {
      [helpers.js]
      [constants.js]
    }
  }

  package "routing/" {
    [App.jsx]
    [ProtectedRoute.jsx]
  }

  package "state/" {
    [queryClient.js\n(TanStack Query)]
  }
}

' Relations
[App.jsx] --> [LoginPage.jsx]
[App.jsx] --> [Manager.jsx]
[App.jsx] --> [Library.jsx]
[App.jsx] --> [CatalogPage.jsx]
[App.jsx] --> [UsersPage.jsx]

[ProtectedRoute.jsx] --> [AuthContext.jsx]

[LoginPage.jsx] --> [LoginForm.jsx]
[LoginForm.jsx] --> [useAuth.js]
[useAuth.js] --> [auth.service.js]

[Manager.jsx] --> [BookCard.jsx]
[Manager.jsx] --> [useBooks.js]
[useBooks.js] --> [story.service.js]

[Library.jsx] --> [BookGrid.jsx]
[Library.jsx] --> [useLibrary.js]
[useLibrary.js] --> [child.service.js]

[CatalogPage.jsx] --> [BookSelector.jsx]
[CatalogPage.jsx] --> [useCatalog.js]
[useCatalog.js] --> [editor.service.js]

[UsersPage.jsx] --> [UserTable.jsx]
[UsersPage.jsx] --> [useUsers.js]
[useUsers.js] --> [admin.service.js]

' Services utilisent les composants partagés
[auth.service.js] --> [useFetch.js]
[story.service.js] --> [useFetch.js]
[child.service.js] --> [useFetch.js]
[editor.service.js] --> [useFetch.js]
[admin.service.js] --> [useFetch.js]

' Tous les services utilisent TanStack Query
[useAuth.js] --> [queryClient.js\n(TanStack Query)]
[useBooks.js] --> [queryClient.js\n(TanStack Query)]
[useLibrary.js] --> [queryClient.js\n(TanStack Query)]
[useCatalog.js] --> [queryClient.js\n(TanStack Query)]
[useUsers.js] --> [queryClient.js\n(TanStack Query)]

note right of "features/"
  **Architecture Feature-Based** :

  Chaque feature est autonome et contient :
  • **pages/** : Composants de pages React
  • **components/** : Composants réutilisables de la feature
  • **services/** : Appels API spécifiques
  • **hooks/** : Hooks custom React Query
  • **context/** : État global si nécessaire

  **Avantages** :
  • Colocation du code lié
  • Facilité de navigation
  • Suppression/ajout de features facile
  • Responsabilités claires
  • Scalabilité horizontale
end note

note left of "shared/"
  **Composants partagés** :

  • Composants UI réutilisables (Button, Input, etc.)
  • Hooks génériques (useFetch, useDebounce)
  • Utilitaires et constantes globales

  **Principe DRY** :
  Don't Repeat Yourself - Éviter la duplication
end note

note bottom of [queryClient.js\n(TanStack Query)]
  **TanStack Query (React Query)** :

  Gestion de l'état serveur :
  • Cache intelligent
  • Synchronisation automatique
  • Gestion des erreurs
  • Retry automatique
  • Optimistic updates
  • Pagination & Infinite scroll

  **Configuration** :
  • staleTime: 5 minutes
  • cacheTime: 10 minutes
  • refetchOnWindowFocus: true
end note

legend right
  **Flux de données** :

  Page → Hook → Service → Backend API
    ↓       ↓        ↓
  UI   Cache   HTTP   JSON

  **Exemple concret (Création de livre)** :

  1. Manager.jsx (page)
  2. useBooks.js (hook avec useMutation)
  3. story.service.js (fetch POST /books)
  4. Backend Spring Boot (/books endpoint)
  5. Invalidation du cache (refetch automatique)
  6. UI mise à jour automatiquement
endlegend

@enduml
